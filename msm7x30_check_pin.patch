diff --git a/combinedroot/init.sh b/combinedroot/init.sh
index e4dda96..78404c6 100644
--- a/combinedroot/init.sh
+++ b/combinedroot/init.sh
@@ -52,8 +52,18 @@ busybox sleep 3
 # android ramdisk
 load_image=/sbin/ramdisk.cpio
 
+# setup pincode
+busybox mkdir -p /cache/pin
+busybox chmod -R 770 /cache/pin
+busybox chown -R root:system /cache/pin
+
+powered=`cat /sys/devices/virtual/power_supply/hsusb_chg/online`
+if [ ! -e /cache/pin/code -o "${powered}" = "1" ]; then
+	busybox touch /cache/pin/ok
+fi
+
 # boot decision
-if [ -s /dev/keycheck -o -e /cache/recovery/boot ]
+if [ -s /dev/keycheck -o -e /cache/recovery/boot -o ! -e /cache/pin/ok ]
 then
 	busybox echo 'RECOVERY BOOT' >>boot.txt
 	busybox rm -fr /cache/recovery/boot
@@ -69,6 +79,10 @@ then
 	load_image=/sbin/ramdisk-recovery.cpio
 else
 	busybox echo 'ANDROID BOOT' >>boot.txt
+	if [ -e /cache/pin/code ]
+	then
+		busybox rm -fr /cache/pin/ok
+	fi
 	# poweroff LED & button-backlight
 	busybox echo 0 > ${BOOTREC_LED_RED}/brightness
 	busybox echo 0 > ${BOOTREC_LED_GREEN}/brightness
